(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{406:function(t,s,e){t.exports=e.p+"assets/img/image-20241222150347223.75d04bf8.png"},407:function(t,s,e){t.exports=e.p+"assets/img/image-20241222153508118.fd7c5001.png"},408:function(t,s,e){t.exports=e.p+"assets/img/image-20241222153448489.8e8fc118.png"},409:function(t,s,e){t.exports=e.p+"assets/img/image-20241222153547809.cca03f91.png"},410:function(t,s,e){t.exports=e.p+"assets/img/image-20241222154613953.ee10ccdb.png"},411:function(t,s,e){t.exports=e.p+"assets/img/image-20241222154626725.46335b86.png"},412:function(t,s,e){t.exports=e.p+"assets/img/image-20241222154915998.851bee01.png"},413:function(t,s,e){t.exports=e.p+"assets/img/image-20250108143443953.e877510c.png"},414:function(t,s,e){t.exports=e.p+"assets/img/image-20250108143606522.08d72924.png"},415:function(t,s,e){t.exports=e.p+"assets/img/image-20241222155831594.dcfd4d09.png"},451:function(t,s,e){"use strict";e.r(s);var a=e(25),r=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"手把手教你玩转-一站式运维平台-codo-7-使用通知中心完成高效率告警"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#手把手教你玩转-一站式运维平台-codo-7-使用通知中心完成高效率告警"}},[t._v("#")]),t._v(" 手把手教你玩转 一站式运维平台(CODO) - 7.使用通知中心完成高效率告警")]),t._v(" "),s("h2",{attrs:{id:"项目结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目结构"}},[t._v("#")]),t._v(" 项目结构")]),t._v(" "),s("p",[s("img",{attrs:{src:e(406),alt:"image-20241222150347223"}})]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v(".\n├── docs\n├── etc\n├── internal\n│   ├── biz\n│   ├── conf\n│   ├── dep\n│   ├── ievents\n│   ├── imiddleware\n│   ├── impl\n│   │   ├── alerts\n│   │   └── data\n│   │       └── models\n│   ├── pkg\n│   │   └── istr\n│   ├── server\n│   └── service\n├── meta\n├── pb\n│   ├── channel\n│   ├── healthy\n│   ├── router\n│   ├── templates\n│   └── user\n├── scripts\n└── third_party\n    ├── google\n    │   ├── api\n    │   └── protobuf\n    │       └── compiler\n    ├── khttp\n    ├── openapi\n    │   └── v3\n    └── validate\n")])])]),s("h2",{attrs:{id:"术语解释"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#术语解释"}},[t._v("#")]),t._v(" 术语解释")]),t._v(" "),s("ul",[s("li",[t._v("消息模板(无状态): 一个消息的模板定义, 负责定义渲染引擎 & 发出渠道")]),t._v(" "),s("li",[t._v("通知通道(有状态): 一组通知的集合, 在不同的通知级别中, 发向不同的 "),s("strong",[t._v("消息模板")]),t._v(", 同时在这里配置 "),s("strong",[t._v("消息模板")]),t._v(" 的渠道方的配置(密钥等)")]),t._v(" "),s("li",[t._v("通知路由(有状态): 一个消息解析&路由器, 作为一个 http 回调端点, 对回调的内容进行解析, 并将消息路由到对应配置的 "),s("strong",[t._v("通知通道")]),t._v(".\n"),s("ul",[s("li",[t._v("labels: 通知进行路由的数据依据, 从回调的 httpQuery 和 jsonBody 两处取值进行合并, 相同key 时, jsonBody 优先")]),t._v(" "),s("li",[t._v("data: 用于消息模板的数据渲染, 从 jsonBody 取值")])])])]),t._v(" "),s("h2",{attrs:{id:"快速入门"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速入门"}},[t._v("#")]),t._v(" 快速入门")]),t._v(" "),s("h3",{attrs:{id:"配置消息模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置消息模板"}},[t._v("#")]),t._v(" 配置消息模板")]),t._v(" "),s("p",[t._v("在 消息模板 页签, 点击 创建, 即可进行配置.")]),t._v(" "),s("p",[t._v("模板用途 用于在配置通知通道时, 与对应的通道通途对应.")]),t._v(" "),s("p",[t._v("目前支持:")]),t._v(" "),s("ul",[s("li",[t._v("飞书机器人(飞书 webhook 机器人)")]),t._v(" "),s("li",[t._v("飞书应用(飞书bot 单聊)")]),t._v(" "),s("li",[t._v("钉钉机器人(钉钉 webhook 机器人)")]),t._v(" "),s("li",[t._v("钉钉应用(钉钉bot 单聊)")]),t._v(" "),s("li",[t._v("企业微信机器人(企业微信 webhook 机器人)")]),t._v(" "),s("li",[t._v("企业微信应用(企业微信bot 单聊)")]),t._v(" "),s("li",[t._v("阿里云短信")]),t._v(" "),s("li",[t._v("阿里云电话")]),t._v(" "),s("li",[t._v("腾讯云短信")]),t._v(" "),s("li",[t._v("腾讯云电话")]),t._v(" "),s("li",[t._v("邮件")]),t._v(" "),s("li",[t._v("webhook")])]),t._v(" "),s("p",[s("img",{attrs:{src:e(407),alt:"image-20241222153508118"}})]),t._v(" "),s("h3",{attrs:{id:"快速调试-飞书webhook机器人为例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速调试-飞书webhook机器人为例"}},[t._v("#")]),t._v(" 快速调试(飞书webhook机器人为例)")]),t._v(" "),s("p",[t._v("在填入 "),s("strong",[t._v("模板内容")]),t._v(" 之后, 点击 "),s("strong",[t._v("保存")]),t._v(" 之后, 可以对模板进行快速调试, 在 "),s("strong",[t._v("地址")]),t._v(" + "),s("strong",[t._v("密钥")]),t._v(" 上填入 "),s("strong",[t._v("飞书webhook机器人")]),t._v(" 的配置")]),t._v(" "),s("p",[t._v("关于添加自定义机器人, 可以查看: "),s("a",{attrs:{href:"https://open.feishu.cn/document/client-docs/bot-v3/add-custom-bot?lang=zh-CN",target:"_blank",rel:"noopener noreferrer"}},[t._v("飞书自定义机器人指南"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("img",{attrs:{src:e(408),alt:"image-20241222153448489"}})]),t._v(" "),s("p",[s("img",{attrs:{src:e(409),alt:"image-20241222153547809"}})]),t._v(" "),s("h3",{attrs:{id:"配置通知通道"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置通知通道"}},[t._v("#")]),t._v(" 配置通知通道")]),t._v(" "),s("p",[t._v("注意事项:")]),t._v(" "),s("ul",[s("li",[t._v("选中对应的 "),s("strong",[t._v("通道用途")]),t._v(" 之后, 后续只能选择 "),s("strong",[t._v("对应通道用途")]),t._v(" 的 "),s("strong",[t._v("消息模板")])]),t._v(" "),s("li",[s("strong",[t._v("通知用户")]),t._v(" 为默认通知用户, 可以在通知路由回调接口时, body 中传入 key 为 “noticer”, value 为 “英文逗号分隔的用户名”, 用于替换")]),t._v(" "),s("li",[t._v("默认提供两个固定模板(作为简单使用, 无需配置 "),s("strong",[t._v("通知模板")]),t._v("), 如果不需要可以 告警级别设置为空(电话告警), webhook 设置为空(飞书机器人告警)")])]),t._v(" "),s("p",[t._v("配置基础信息:")]),t._v(" "),s("p",[s("img",{attrs:{src:e(410),alt:"image-20241222154613953"}})]),t._v(" "),s("p",[t._v("配置固定模板:")]),t._v(" "),s("p",[s("img",{attrs:{src:e(411),alt:"image-20241222154626725"}})]),t._v(" "),s("p",[t._v("配置自定义模板:")]),t._v(" "),s("p",[s("img",{attrs:{src:e(412),alt:"image-20241222154915998"}})]),t._v(" "),s("h4",{attrs:{id:"回调配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#回调配置"}},[t._v("#")]),t._v(" 回调配置")]),t._v(" "),s("p",[t._v("还可以配置回调用于信息交互")]),t._v(" "),s("p",[s("img",{attrs:{src:e(413),alt:"image-20250108143443953"}})]),t._v(" "),s("p",[t._v("展示")]),t._v(" "),s("p",[s("img",{attrs:{src:e(414),alt:"image-20250108143606522"}})]),t._v(" "),s("h3",{attrs:{id:"配置通知路由"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置通知路由"}},[t._v("#")]),t._v(" 配置通知路由")]),t._v(" "),s("p",[t._v("注意:")]),t._v(" "),s("ul",[s("li",[t._v("通知路由地址: "),s("strong",[t._v("网关地址/api/noc/v1/router-alert")]),t._v(" ( 支持 POST | GET )")]),t._v(" "),s("li",[t._v("http post 中的 jsonBody 会用作消息模板的数据渲染")]),t._v(" "),s("li",[t._v("jsonBody 和 httpQuery 部份会一起作为 "),s("strong",[t._v("labels数据")]),t._v(" 进行通知路由匹配")]),t._v(" "),s("li",[t._v("如果 severity 为空, 则默认级别为 “警告”")])]),t._v(" "),s("p",[t._v("特殊业务意义字段:")]),t._v(" "),s("div",{staticClass:"language-golang extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('FieldsMessage     = "message"      // 通用消息字段 (从 jsonBody 取值)\nFieldsManager     = "codo_manager" // 业务负责人 (从 httpQuery + jsonBody 取值)\nFieldsNoticer     = "codo_noticer" // 内置通知人 (从 httpQuery + jsonBody 取值)\nFieldsSeverity    = "severity"     // 告警等级 [fatal | error | warn | info] (从 httpQuery + jsonBody 取值)\nFieldsTitle       = "title"        // 告警标题 (从 httpQuery + jsonBody 取值)\nFieldsNativeTitle = "codo_title"   // 原生标题 不做其他处理 (从 httpQuery + jsonBody 取值)\nFieldsStatus      = "status"       // 告警状态 [resolved | firing | resolving | inactive] (从 httpQuery + jsonBody 取值)\nFieldsAppCn       = "cmdb_bizcn"   // 业务中文描述 (从 httpQuery + jsonBody 取值)\nFieldsCallbackArgs = "codo_callback_args" // 回调参数, 只能是个字符串 (从 httpQuery + jsonBody 取值)\n')])])]),s("p",[s("img",{attrs:{src:e(415),alt:"image-20241222155831594"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);